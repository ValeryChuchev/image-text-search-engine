# Поиск изображений по текстовому описанию

##  О проекте

Проект по разработке системы семантического поиска изображений для фотохостинга "Со Смыслом". Система позволяет находить релевантные фотографии по текстовому описанию с учетом юридических ограничений и требований конфиденциальности.

##  Цели проекта

- Создание модели для поиска изображений по текстовым запросам
- Обеспечение compliance с юридическими ограничениями (защита детского контента)
- Достижение высокой точности соответствия текст-изображение
- Разработка прототипа для демонстрации Proof of Concept (PoC)

##  Данные

### Основные файлы:
- **train_dataset.csv** - обучающие данные: изображения и текстовые описания
- **train_images/** - папка с обучающими изображениями
- **CrowdAnnotations.tsv** - разметка от краудсорсинга
- **ExpertAnnotations.tsv** - экспертные оценки соответствия
- **test_queries.csv** - тестовые запросы для валидации
- **test_images/** - тестовые изображения

### Структура данных:
- До 5 текстовых описаний на одно изображение
- Экспертные оценки по шкале 1-4
- Краудсорсинговые оценки соответствия

##  Технологии

- **Python 3.8+**
- **PyTorch** - глубокое обучение и модели
- **Transformers** - работа с NLP моделями
- **CLIP** - контрастная learning модель от OpenAI
- **ResNet50** - извлечение признаков из изображений
- **OpenCV/PIL** - обработка изображений
- **Scikit-learn** - классические ML модели и метрики

##  Ключевые этапы работы

### 1. Исследовательский анализ данных
- Анализ распределения экспертных оценок
- Исследование качества текстовых описаний
- Визуализация примеров изображений и соответствующих описаний
- Проверка на наличие дубликатов и аномалий

### 2. Подготовка данных и compliance
- Создание списка запрещенных слов (дети, несовершеннолетние и т.д.)
- Фильтрация обучающих данных от потенциально проблемного контента
- Реализация механизма дисклеймеров для запрещенного контента

### 3. Векторизация данных

#### Для изображений:
- **ResNet50** с предобученными весами
- Извлечение features из последнего слоя перед classification
- Размерность вектора: 2048

#### Для текста:
- **CLIP text encoder** - современный подход
- Альтернативно: TF-IDF, Word2Vec, BERT
- Размерность вектора: 512 (для CLIP)

### 4. Построение и сравнение моделей

#### Тестируемые подходы:
- **DummyRegressor** - базовая линия (MSE: 0.0568)
- **Linear Regression** - линейная модель (MSE: 0.1971)
- **Neural Network (PyTorch)** - полносвязная сеть (MSE: 0.0450)
- **CLIP Zero-shot** - современный подход без дообучения

### 5. Тестирование и валидация
- Разделение на train/validation/test
- Кросс-валидация для стабильности результатов
- Тестирование на отдельных запросах с визуализацией
- Проверка работы фильтра запрещенного контента

##  Результаты

### Сравнение моделей:

| Модель | MSE | Преимущества | Недостатки |
|--------|-----|--------------|------------|
| **CLIP Zero-shot** | **Наилучшее** | Высокое качество, нет обучения | Требует GPU |
| **Neural Network** | 0.0450 | Хорошее качество, быстрое предсказание | Требует обучения |
| **DummyRegressor** | 0.0568 | Простая реализация | Низкое качество |
| **Linear Regression** | 0.1971 | Интерпретируемость | Низкое качество |

### Ключевые достижения:
- ✅ **Высокое качество поиска**: CLIP показывает наилучшие результаты
- ✅ **Юридическая compliance**: Реализована фильтрация запрещенного контента
- ✅ **Рабочий прототип**: Готовая система для демонстрации PoC
- ✅ **Масштабируемость**: Поддержка больших объемов данных

##  Анализ результатов

### Качество поиска:
- **CLIP**: Наилучшее семантическое понимание запросов
- **Нейросеть**: Хорошая альтернатива при ограниченных ресурсах
- **Линейные модели**: Не справляются со сложными зависимостями
